<?php

use Drupal\wisski_core\WisskiEntityInterface;

function wisski_core_generate_title(WisskiEntityInterface $wisski_individual) {
//ddebug_backtrace();
  $bundle = \Drupal\wisski_core\Entity\WisskiBundle::load($wisski_individual->bundle());
  $title = $bundle->generateEntityTitle($wisski_individual);
  return $title;
}


function wisski_core_flush_title_caches($bundle_ids=NULL,$entity_ids=NULL) {

  if (is_null($bundle_ids)) {
    \Drupal\wisski_core\WisskiCacheHelper::flushAllEntityTitles();
    return;
  }
  $bundles = \Drupal\wisski_core\Entity\WisskiBundle::loadMultiple($bundle_ids);
  foreach ($bundles as $bundle) {
    $bundle->flushTitleCache($entity_ids);
  }
}

function wisski_trace($dpm=TRUE) {

  $trace = debug_backtrace(DEBUG_BACKTRACE_IGNORE_ARGS,3);
  if ($dpm && function_exists('dpm')) {
    $label = (string) $trace[1]['function'].'() called from';
    dpm(array($label => $trace[2]),__METHOD__);
  }
  return $trace[2];
}